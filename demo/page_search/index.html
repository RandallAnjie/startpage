<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>
        RSearch
    </title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        html {
            background-color: #222;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAGklEQVQIW2NkYGD4D8SMQAwGcAY2AbBKDBUAVuYCBQPd34sAAAAASUVORK5CYII=);
            background-repeat: repeat;
        }

        h1,
        h2 {
            font-size: 24px;
        }

        p {
            margin: 10px 0 10px 0;
            font-size: 16px;
            line-height: 1.32;
        }

        a {
            color: #7aa76d;
            text-decoration: none;

            -webkit-transition: 0.15s color ease;
            -moz-transition: 0.15s color ease;
            -ms-transition: 0.15s color ease;
            -o-transition: 0.15s color ease;
            transition: 0.15s color ease;
        }

        a:hover {
            color: #91cd85;
        }

        input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        input:focus {
            border-color: #7aa76d;
        }

        small {
            display: block;
            margin-top: 15px;
            padding-top: 15px;
            color: #333;
            font-size: 0.85em;
            border-top: 1px dashed #ccc;

            -webkit-text-size-adjust: none;
        }

        button {
            border: 0px;
            padding: 8px 10px;
            margin: 5px 0px;
            border-radius: 1px;
            outline: 0;

            float: right;

            cursor: pointer;
            color: #fff;
            background: #7aa76d;
            font-size: 15px;

            -webkit-transition: 0.15s background ease;
            -moz-transition: 0.15s background ease;
            -ms-transition: 0.15s background ease;
            -o-transition: 0.15s background ease;
            transition: 0.15s background ease;
        }

        button:hover {
            background: #91cd85;
        }

        button:active {
            background: #60895a;
        }

        button+button {
            margin-left: 5px;
        }

        .sharing {
            margin-top: 50px;
        }

        body {
            background: #fff;

            font-family: 'Lato', Helvetica, sans-serif;
            font-size: 16px;
            color: #222;
        }

        .avgrund-active body {
            -webkit-transform: scale(0.9);
            -moz-transform: scale(0.9);
            -ms-transform: scale(0.9);
            -o-transform: scale(0.9);
            transform: scale(0.9);
        }

        .avgrund-cover {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
            visibility: hidden;
            opacity: 0;
            background: rgba(0, 0, 0, 0.5);
        }

        .avgrund-active .avgrund-cover {
            visibility: visible;
            opacity: 1;
        }

        .avgrund-contents {
            position: relative;
            padding: 20px;
            max-width: 80%;
            height: 100%;
            margin: auto;
        }

        .avgrund-active .avgrund-contents {
            -webkit-filter: blur(2px);
            -moz-filter: blur(2px);
            -ms-filter: blur(2px);
            -o-filter: blur(2px);
            filter: blur(2px);
        }

        .no-blur.avgrund-active .avgrund-contents {
            -webkit-filter: none;
            -moz-filter: none;
            -ms-filter: none;
            -o-filter: none;
            filter: none;
        }

        .avgrund-popup {
            position: absolute;
            width: 340px;
            height: 130px;
            left: 50%;
            top: 50%;
            margin: -130px 0 0 -190px;
            visibility: hidden;
            opacity: 0;
            z-index: 2;
            padding: 20px;

            background: white;
            box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.6);
            border-radius: 3px;

            -webkit-transform: scale(0.8);
            -moz-transform: scale(0.8);
            -ms-transform: scale(0.8);
            -o-transform: scale(0.8);
            transform: scale(0.8);
        }

        .avgrund-active .avgrund-popup {
            visibility: visible;
            opacity: 1;

            -webkit-transform: scale(1.1);
            -moz-transform: scale(1.1);
            -ms-transform: scale(1.1);
            -o-transform: scale(1.1);
            transform: scale(1.1);
        }

        .avgrund-popup.stack {
            -webkit-transform: scale(1.5);
            -moz-transform: scale(1.5);
            -ms-transform: scale(1.5);
            -o-transform: scale(1.5);
            transform: scale(1.5);
        }

        .avgrund-active .avgrund-popup.stack {
            -webkit-transform: scale(1.1);
            -moz-transform: scale(1.1);
            -ms-transform: scale(1.1);
            -o-transform: scale(1.1);
            transform: scale(1.1);
        }


        .avgrund-ready body,
        .avgrund-ready .avgrund-contents,
        .avgrund-ready .avgrund-popup,
        .avgrund-ready .avgrund-cover {
            -webkit-transform-origin: 50% 50%;
            -moz-transform-origin: 50% 50%;
            -ms-transform-origin: 50% 50%;
            -o-transform-origin: 50% 50%;
            transform-origin: 50% 50%;

            -webkit-transition: 0.3s all cubic-bezier(0.250, 0.460, 0.450, 0.940);
            -moz-transition: 0.3s all cubic-bezier(0.250, 0.460, 0.450, 0.940);
            -ms-transition: 0.3s all cubic-bezier(0.250, 0.460, 0.450, 0.940);
            -o-transition: 0.3s all cubic-bezier(0.250, 0.460, 0.450, 0.940);
            transition: 0.3s all cubic-bezier(0.250, 0.460, 0.450, 0.940);
        }

        .avgrund-ready .avgrund-popup.no-transition {
            -webkit-transition: none;
            -moz-transition: none;
            -ms-transition: none;
            -o-transition: none;
            transition: none;
        }

        #magnifier {
            width: 40px;
            height: 40px;
            position: fixed;
            right: 20px;
            bottom: 20px;
            cursor: pointer;
            font-size: 40px;
            background-color: #fff;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 50%;
            line-height: 1;
            vertical-align: middle;
        }

        #searchBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 10px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .highlight {
            background-color: yellow;
        }
    </style>
</head>

<body>
    <article class="avgrund-contents">
        <div id="content">
            <h2>å²³é˜³æ¥¼è®°</h2>
            <br />
            åº†å†å››å¹´æ˜¥ï¼Œæ»•å­äº¬è°ªå®ˆå·´é™µéƒ¡ã€‚è¶Šæ˜å¹´ï¼Œæ”¿é€šäººå’Œï¼Œç™¾åºŸå…·å…´ã€‚ä¹ƒé‡ä¿®å²³é˜³æ¥¼ï¼Œå¢å…¶æ—§åˆ¶ï¼Œåˆ»å”è´¤ä»Šäººè¯—èµ‹äºå…¶ä¸Šã€‚å±äºˆä½œæ–‡ä»¥è®°ä¹‹ã€‚
            <br />
            äºˆè§‚å¤«å·´é™µèƒœçŠ¶ï¼Œåœ¨æ´åº­ä¸€æ¹–ã€‚è¡”è¿œå±±ï¼Œåé•¿æ±Ÿï¼Œæµ©æµ©æ±¤æ±¤ï¼Œæ¨ªæ— é™…æ¶¯ï¼›æœæ™–å¤•é˜´ï¼Œæ°”è±¡ä¸‡åƒã€‚æ­¤åˆ™å²³é˜³æ¥¼ä¹‹å¤§è§‚ä¹Ÿï¼Œå‰äººä¹‹è¿°å¤‡çŸ£ã€‚ç„¶åˆ™åŒ—é€šå·«å³¡ï¼Œå—ææ½‡æ¹˜ï¼Œè¿å®¢éªšäººï¼Œå¤šä¼šäºæ­¤ï¼Œè§ˆç‰©ä¹‹æƒ…ï¼Œå¾—æ— å¼‚ä¹ï¼Ÿ
            <br />
            è‹¥å¤«æ·«é›¨éœéœï¼Œè¿æœˆä¸å¼€ï¼Œé˜´é£æ€’å·ï¼ŒæµŠæµªæ’ç©ºï¼›æ—¥æ˜Ÿéšæ›œï¼Œå±±å²³æ½œå½¢ï¼›å•†æ—…ä¸è¡Œï¼Œæ¨¯å€¾æ¥«æ‘§ï¼›è–„æš®å†¥å†¥ï¼Œè™å•¸çŒ¿å•¼ã€‚ç™»æ–¯æ¥¼ä¹Ÿï¼Œåˆ™æœ‰å»å›½æ€€ä¹¡ï¼Œå¿§è°—ç•è®¥ï¼Œæ»¡ç›®è§ç„¶ï¼Œæ„Ÿæè€Œæ‚²è€…çŸ£ã€‚
            <br />
            è‡³è‹¥æ˜¥å’Œæ™¯æ˜ï¼Œæ³¢æ¾œä¸æƒŠï¼Œä¸Šä¸‹å¤©å…‰ï¼Œä¸€ç¢§ä¸‡é¡·ï¼›æ²™é¸¥ç¿”é›†ï¼Œé”¦é³æ¸¸æ³³ï¼›å²¸èŠ·æ±€å…°ï¼Œéƒéƒé’é’ã€‚è€Œæˆ–é•¿çƒŸä¸€ç©ºï¼Œçš“æœˆåƒé‡Œï¼Œæµ®å…‰è·ƒé‡‘ï¼Œé™å½±æ²‰ç’§ï¼Œæ¸”æ­Œäº’ç­”ï¼Œæ­¤ä¹ä½•æï¼ç™»æ–¯æ¥¼ä¹Ÿï¼Œåˆ™æœ‰å¿ƒæ—·ç¥æ€¡ï¼Œå® è¾±å•å¿˜ï¼ŒæŠŠé…’ä¸´é£ï¼Œå…¶å–œæ´‹æ´‹è€…çŸ£ã€‚
            <br />
            å—Ÿå¤«ï¼äºˆå°æ±‚å¤ä»äººä¹‹å¿ƒï¼Œæˆ–å¼‚äºŒè€…ä¹‹ä¸ºã€‚ä½•å“‰ï¼Ÿä¸ä»¥ç‰©å–œï¼Œä¸ä»¥å·±æ‚²ï¼›å±…åº™å ‚ä¹‹é«˜åˆ™å¿§å…¶æ°‘ï¼›å¤„æ±Ÿæ¹–ä¹‹è¿œåˆ™å¿§å…¶å›ã€‚æ˜¯è¿›äº¦å¿§ï¼Œé€€äº¦å¿§ã€‚ç„¶åˆ™ä½•æ—¶è€Œä¹è€¶ï¼Ÿå…¶å¿…æ›°ï¼šâ€œå…ˆå¤©ä¸‹ä¹‹å¿§è€Œå¿§ï¼Œåå¤©ä¸‹ä¹‹ä¹è€Œä¹â€ä¹ã€‚å™«ï¼å¾®æ–¯äººï¼Œå¾è°ä¸å½’ï¼Ÿ
            <br />
            æ—¶å…­å¹´ä¹æœˆåäº”æ—¥ã€‚
        </div>
    </article>
    <div id="magnifier">ğŸ”</div>
    <div class="avgrund-cover">
    </div>
    <aside class="avgrund-popup">
        <input id="searchInput" placeholder="è¯·è¾“å…¥æœç´¢å†…å®¹" type="text" />
        <button onclick="avgrund.deactivate();">
            æœç´¢å¹¶å…³é—­è¾“å…¥æ¡†
        </button>
    </aside>
    <script>
        const magnifier = document.getElementById("magnifier");
        const searchInput = document.getElementById("searchInput");
        const content = document.getElementById("content");
        let isComposing = false;

        magnifier.onclick = function () {
            avgrund.activate("stack");
            avgrund.disableBlur();  // ç¦ç”¨æ¨¡ç³Š
            setTimeout(function () {
                searchInput.focus();
            }, 300);
        };

        /**
         * æ¸…é™¤é«˜äº®
         * @Author: Anjie
         * @Date:   2023-09-11
         */
        function clearHighlights() {
            let highlighted = document.querySelectorAll(".highlight");
            highlighted.forEach(element => {
                element.outerHTML = element.innerHTML;
            });
        }

        searchInput.addEventListener('keyup', function (e) {
            if (e.key === "Enter") {
                avgrund.deactivate();
            }
        });

        searchInput.addEventListener('compositionstart', function () {
            isComposing = true;
        });

        searchInput.addEventListener('compositionend', function () {
            isComposing = false;
            searchFunction();
        });

        searchInput.addEventListener('input', function () {
            if (!isComposing) {
                searchFunction();
            }
        });

        /**
         * æœç´¢åŠŸèƒ½
         * @Author: Anjie
         * @Date:   2023-09-11
         */
        function searchFunction() {
            clearHighlights();
            let searchText = searchInput.value;
            if (searchText) {
                let searchPattern = new RegExp("(" + searchText + ")", "gi");
                content.innerHTML = content.innerHTML.replace(searchPattern, "<span class='highlight'>$1</span>");
            }
        }

        (function () {

            var container = document.documentElement,
                popup = document.querySelector('.avgrund-popup'),
                cover = document.querySelector('.avgrund-cover'),
                currentState = null;

            addClass(container, 'avgrund-ready');

            /**
             * å¼¹èµ·é”®ç›˜äº‹ä»¶
             * @Author: Anjie
             * @Date:   2023-09-11
             * @param event
             */
            function onDocumentKeyUp(event) {
                if (event.keyCode === 27) {
                    deactivate();
                }
            }

            /**
             * ç‚¹å‡»äº‹ä»¶
             * @Author: Anjie
             * @Date:   2023-09-11
             * @param event
             */
            function onDocumentClick(event) {
                if (event.target === cover) {
                    deactivate();
                }
            }

            /**
             * æ‰“å¼€å¼¹çª—
             * @Author: Anjie
             * @Date:   2023-09-11
             * @param state
             */
            function activate(state) {
                document.addEventListener('keyup', onDocumentKeyUp, false);
                document.addEventListener('click', onDocumentClick, false);

                removeClass(popup, currentState);
                addClass(popup, 'no-transition');
                addClass(popup, state);

                setTimeout(function () {
                    removeClass(popup, 'no-transition');
                    addClass(container, 'avgrund-active');
                }, 0);

                currentState = state;
            }

            /**
             * å…³é—­å¼¹çª—
             * @Author: Anjie
             * @Date:   2023-09-11
             */
            function deactivate() {
                document.removeEventListener('keyup', onDocumentKeyUp, false);
                document.removeEventListener('click', onDocumentClick, false);

                removeClass(container, 'avgrund-active');
            }

            /**
             * ç¦ç”¨æ¨¡ç³Š
             * @Author: Anjie
             * @Date:   2023-09-11
             */
            function disableBlur() {
                addClass(document.documentElement, 'no-blur');
            }

            /**
             * æ·»åŠ ç±»
             * @Author: Anjie
             * @Date:   2023-09-11
             * @param element
             * @param name
             */
            function addClass(element, name) {
                element.className = element.className.replace(/\s+$/gi, '') + ' ' + name;
            }

            /**
             * ç§»é™¤ç±»
             * Author: Anjie
             * @Date:   2023-09-11
             * @param element
             * @param name
             */
            function removeClass(element, name) {
                element.className = element.className.replace(name, '');
            }

            /**
             * æš´éœ²æ¥å£
             * activate: æ‰“å¼€å¼¹çª—
             * deactivate: å…³é—­å¼¹çª—
             * disableBlur: ç¦ç”¨æ¨¡ç³Š
             * @type {{activate: activate, disableBlur: disableBlur, deactivate: deactivate}}
             */
            window.avgrund = {
                activate: activate,
                deactivate: deactivate,
                disableBlur: disableBlur
            }
        })();
    </script>
</body>

</html>
